---
title: "Examining the Impact of School Closures on COVID-19 Infections in Europe and their Effects on Different Age Cohorts"
short_title: "Impact of School Closures on COVID-19 by Age Cohorts"
short_author: "Dupré & Morgenroth"
authors: 
- name: "Damien Dupré"
  affiliation: "Business School, Dublin City University"
  city: "Dublin"
  country: "Ireland"
  email: "damien.dupre\\@dcu.ie"
  footnote: 1
- name: "Edgar Morgenroth"
  affiliation: "Business School, Dublin City University"
  city: "Dublin"
  country: "Ireland"
  email: "edgar.morgenroth\\@dcu.ie"
  footnote: 2
footnote:
  - code: 1
    text: "Corresponding Author"
  - code: 2
    text: "Equal contribution"
abstract: |
  This paper presents a comprehensive analysis of COVID-19 case trends and the influence of age groups in selected European countries. The study examines the relationship between population size and the total number of confirmed cases, revealing that larger countries tend to have higher case numbers. The impact of different waves on age groups is investigated, with the first wave affecting older age groups and the third wave primarily impacting the youngest age groups. The study also evaluates the effects of school closures on COVID-19 cases using a Generalized Additive Model (GAM). The findings demonstrate a decreasing non-linear effect of school closure across all countries studied. Moreover, the analysis of age groups reveals distinct patterns, with the 0 to 4 age group experiencing a downward trend after school closure, while age groups 5 to 14 exhibit a significant increase in cases. Age groups 15 to 24 show a surge immediately after closure, followed by a decline. Additionally, Transfer Entropy calculations highlight asymmetry in age group influences, indicating that changes in COVID-19 cases in certain age groups predict changes in other age groups but not vice versa. The study also identifies consistent patterns across countries, such as the predictive influence of younger cohorts on older cohorts in Austria, Germany, and the Netherlands. Conversely, Portugal and Spain show a predictive influence of older cohorts on younger cohorts. These findings contribute to a better understanding of COVID-19 dynamics in European countries and provide insights for public health strategies and interventions.
keywords: COVID-19, School Closures, Causality, Generalised Additive Model, Transfer Entropy
bibliography: "bibliography.bib"
header-includes:
  - \usepackage{float}
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{threeparttable}
  - \floatplacement{figure}{H}
  - \floatplacement{table}{H}
  - \usepackage{caption}

output:
  bookdown::pdf_book:
    base_format: rticles::rss_article
    keep_tex: false
  bookdown::word_document2:
    default
knit: (function(input, ...) {
    rmarkdown::render(
      input,
      output_dir = here::here("output"),
      output_file = c(glue::glue("{xfun::sans_ext(input)}.pdf"), glue::glue("{xfun::sans_ext(input)}.docx")),
      output_format = "all",
      envir = globalenv()
    )
  })
---

(ref:overall) Cumulative COVID-19 cases number for selected European countries since the beginning of the pandemic. Source: COVerAGE-DB [@riffe2021data].
(ref:descriptive) Periods of schools closure since the beginning of the COVID-19 pandemic for selected European countries and their reason: regular academic break vs. closure due to government decisions. Source: @unesco2022https.
(ref:country) Standardized effect of the smooth term in Generalized Additive Model by country.
(ref:age) Standardized effect of the smooth term in Generalized Additive Model by age group.
(ref:te) Matrix of Transfer Entropy coefficients according every age group combination for each of the selected European country. Age groups on the x-axis are influencing the age groups on the y-axis ($ag\,x \rightarrow\,ag\,y$). The significance of each Transfer Entropy coefficient is provided in the Appendix 2.

```{r setup, include = FALSE}
# libraries --------------------------------------------------------------------
library(ggrepel)
library(here)
library(janitor)
library(knitr)
library(osfr)
library(scales)
library(tidyverse)

# options ----------------------------------------------------------------------
set.seed(123) # Seed for random number generation
options(scipen = 999) # disable sci number format
opts_chunk$set(
  cache.extra = rand_seed, 
  cache = FALSE,
  message = FALSE, 
  warning = FALSE, 
  error = FALSE,
  echo = FALSE, 
  fig.retina = 3,
  dev = "ragg_png"
  )

# raw data ---------------------------------------------------------------------
# osf_retrieve_file("7tnfh") |>
#   osf_download(conflicts = "overwrite", progress = TRUE, verbose = TRUE)
# 
# df <- "Output_5.zip" |>
#   read_csv(skip = 3, col_types = "ccccciiddd") |>
#   mutate(Date = as.Date(Date, format = "%d.%m.%Y")) |>
#   clean_names()
# 
# file.remove("Output_5.zip")
# 
# write_csv(df, here("data/df.csv"))
# 
# df <- read_csv(here("data/df.csv"))
# 
# df_school_closure <- 
#   read_csv(
#     "https://en.unesco.org/sites/default/files/covid_impact_education_full.csv",
#     col_types = list(.default = col_character(), Date = col_date(format = "%d/%m/%Y"))) |> 
#   clean_names() |>
#   select(date, country, status) |> 
#   mutate(country = case_when(
#     country == "Bolivia (Plurinational State of)" ~ "Bolivia",  
#     country == "Central African republic" ~ "Central African Republic",
#     country == "Iran (Islamic Republic of)" ~ "Iran",
#     country == "Republic of Moldova" ~ "Moldova",
#     country == "Republic of Korea" ~ "South Korea",
#     country == "United Kingdom of Great Britain and Northern Ireland" ~ "United Kingdom",
#     country == "United States of America" ~ "USA",
#     country == "Viet Nam" ~ "Vietnam",
#     TRUE ~ country
#     )
#   )
# 
# df_check <- 
#   read_csv("https://covid19.who.int/WHO-COVID-19-global-data.csv") |> 
#   clean_names() |> 
#   rename(date = date_reported) |> 
#   mutate(country = case_when(
#     country == "Bolivia (Plurinational State of)" ~ "Bolivia",  
#     country == "Iran (Islamic Republic of)" ~ "Iran",
#     country == "occupied Palestinian territory, including east Jerusalem" ~ "Palestine",
#     country == "Republic of Moldova" ~ "Moldova",
#     country == "Republic of Korea" ~ "South Korea",
#     country == "United States of America" ~ "USA",
#     country == "Venezuela (Bolivarian Republic of)" ~ "Venezuela",
#     country == "Viet Nam" ~ "Vietnam",
#     TRUE ~ country
#     )
#   )
# 
# # variables --------------------------------------------------------------------
# ## keep only closure waves longer than `days_min_closure` but display only the first `days_after_closure`
# days_min_closure <- 21
# days_after_closure <- 28
# ## type of school closure to investigate
# period_closure_to_keep <- c(
#   #"Partially open",
#   "Academic break",
#   "Closed due to COVID-19"
#   )
# 
# ## countries of interest
# countries_of_interest <- c(
#   "Austria", "Belgium", "Bulgaria", "Croatia", "Estonia", "France", 
#   "Germany", "Greece", "Netherlands", "Portugal", "Slovakia", "Spain"
#   )
# 
# # transformed data -------------------------------------------------------------
# df_global <- df |> 
#   filter(
#     country %in% countries_of_interest,
#     date > as.Date("2020-01-01"),
#     region == "All",
#     sex == "b"
#   ) |> 
#   group_by(country, date) |> 
#   summarise(cumulative_cases_cal = sum(cases)) |> 
#   group_by(country) |> 
#   complete(date = full_seq(date, 1)) |> 
#   mutate(
#     timeline = date - lag(date),  # check if gap between dates
#     daily_cases = round(cumulative_cases_cal - lag(cumulative_cases_cal), 0)
#   ) |> 
#   ungroup() |> 
#   left_join(df_school_closure, by = c("date", "country")) |> 
#   group_by(country) |> 
#   fill(status) |> 
#   ungroup() |> 
#   mutate(schools_closed = if_else(status %in% period_closure_to_keep, 1, 0)) |> 
#   drop_na(status) |> 
#   left_join(df_check, by = c("date", "country"))
# 
# write_csv(df_global, here("data/df_global.csv"))
# 
# df_global_age <- df |> 
#   filter(
#     country %in% countries_of_interest,
#     date > as.Date("2020-01-01"),
#     region == "All",
#     sex == "b"
#   ) |> 
#   mutate(
#     age_grp = case_when(
#       age == 0  ~ "aged0to4",
#       age == 5  ~ "aged5to9",
#       age == 10 ~ "aged10to14",
#       age == 15 ~ "aged15to19",
#       age == 20 ~ "aged20to24",
#       between(age, 25, 34) ~ "aged25to34",
#       between(age, 35, 44) ~ "aged35to44",
#       between(age, 45, 54) ~ "aged45to54",
#       between(age, 55, 64) ~ "aged55to64",
#       age > 64 ~ "aged65+"
#     )
#   ) |> 
#   group_by(country, date, age_grp) |> 
#   summarise(cumulative_cases_cal = sum(cases)) |> 
#   group_by(country, age_grp) |> 
#   complete(date = full_seq(date, 1)) |> 
#   mutate(
#     timeline = date - lag(date),  # check if gap between dates
#     daily_cases = round(cumulative_cases_cal - lag(cumulative_cases_cal), 0),
#     daily_changes = daily_cases - lag(daily_cases)
#   ) |> 
#   ungroup()
# 
# write_csv(df_global_age, here("data/df_global_age.csv"))

df_global <- read_csv(here("data/df_global.csv"))
df_global_age <- read_csv(here("data/df_global_age.csv"))
```

```{r analyses, cache=FALSE}
source(here("analysis/gam_analysis_europe.R"))
source(here("analysis/te_analysis_europe.R"))
```

Introduction
==========================

A wide range of non-pharmaceutical interventions (NPI) were enacted to control the spread of COVID-19, particularly in the period of the pandemic when no effective vaccine was available. Due to their social mixing patterns, children have been identified as an age group that can drive the spread of respiratory infections such as influenza [@moser2018estimating], and school closures were found to be effective in mitigating the spread of influenza H1N1in Japan in 2009 [@kawano2015substantial]. It is therefore not surprising that school closures were one of the NPIs that were introduced in many countries to stop the spread of COVID-19. They were used particularly during the initial wave of the pandemic and during subsequent waves when case numbers were high.

Recently a body of literature has shown various negative consequences on child development and health due to school closures. School closures have been found to have negatively affected child mental health [@moulin2022longitudinal], nutrition/obesity [@sugimoto2023temporal], and education [@lerkkanen2023reading]. Some governments are now questioning their decisions to close schools [@de2021determines]. For example the German health minister Karl Lauterbach, in an interview to one of Germany’s publicly funded television stations, admitted that “in retrospect it had been wrong to keep schools and childcare closed for so long” [@ard2023lauterbach].

Even if school closures had negative consequences for children, they might nevertheless have been effective at stopping the spread of COVID-19. However, analysis on the effectiveness of school closures on the spread of COVID-19 remain inconclusive. @alfano2022effects in a study of a panel of European countries found that school closures were associated with a reduced COVID-19 incidence. In contrast, @walsh2021school in a review of 40 studies covering 150 countries concluded that the effectiveness of school closures was uncertain, with 60% having identified no impact and point to the potential for the analysis to be affected by confounding factors and collinearity. The latter shortcomings suggest that it is hard to draw firm inference as even a positive result may not imply causality.

This paper investigates the dynamics of COVID-19 across age groups and how this is affected by school closures. This allows us to identify the effect of school closure on the evolution of COVID-19 cases older age groups including parents, grand parents and relatives about which little is known. In particular, we first use non-linear time series regression to identify the relationship between the school closures and case numbers in different age groups. Then, using the transfer entropy method, we evaluate the impact of case numbers changes between age groups in order to identify if school closure has secondary repercussions in the household. Transfer entropy can adapt to changes in the underlying system dynamics over time. It does not assume stationarity and can capture evolving causal relationships, making it suitable for studying dynamic systems and non-stationary processes such as COVID-19 contaminations.

## Influence of School Closure

Once it was clear that COVID-19 spreads from person to person, it was natural that governments were advised to enact measures to reduce social contact in order to reduce the spread of the virus. Therefore, it is legitimate to believe that by closing schools, a reduction of the contaminations would be observed in the younger age groups. However, the efficiency of school closure on the reduction of COVID-19 cases is still questioned [@bayham2020impact; @esposito2021comprehensive]. While some research has found that school closures contribute to limit or to reduce the growth rate of confirmed cases after implementation [@stage2021shut; @yoshiyuki2020effects], other did not observe a change in the evolution of COVID-19 cases [@chang2020modelling; @iwata2020school]. For instance, a controlled comparison between similar localities in Japan with schools closed and school open did not revealed any evidence that school closures reduced the spread of COVID-19 [@fukumoto2021no]. If the school closure had a real impact on the evolution of confirmed COVID-19 cases, it should be possible to observe a decrease or a least an inflection in the trend of its evolution among younger age groups.

## Causal Relationship Between Age Groups

A second implicit belief regarding the effect of school closure on the spread of COVID-19 is that school not only has an effect on to the spread of the virus in children and teenagers but also has a knock-on effect on the spread of the virus in older age groups also called Secondary Attack Rate (SAR). The contaminated children and teenagers would bring the virus back at home and, then, they will contaminate their parents and relatives. For example, a research investigating the contamination in the household network not only revealed an exceptional high rate of secondary contamination but also that these contamination happened when the school were closed [@sorianoarandes2021household].

Despite being reported in several clinical and epidemiological studies [@siebach2021childhood; @zhendong2020clinical], multiple research have shown that the SAR from children to household members was, in fact, lower than expected [@heavey2020evidence; @vanderhoek2020role; @kim2021role; @ludvigsson2020children]. However, the SAR of children and teenagers to the household member is likely to be age-dependent, with difference between infants, primary and secondary school children, and college students [@grasleguen2021reopening]. If a secondary transmission from children and teenagers to household member has a significant influence, then a temporal causality relationship between their evolution should be observed.

To evaluate the impact of school closure on COVID-19 cases across different age groups, we first performed a non-linear time series regression to analyze the relationship between school closures and the number of COVID-19 cases in various age groups. In a second analysis, the transfer entropy method is employed to assess the influence of changes in case numbers between age groups, aiming to determine if school closures have secondary effects within households.

Method
============

## Data

### COVID-19 cases per age group

For the analysis data on covid case counts by age group are required. The number of COVID-19 cases per age group has been taken from the COVerAGE-DB project [@riffe2021data]. The COVerAGE-DB project consists in 3 data files: an "Input" data file which collects the official COVID-19 cases from 117 countries, the "Output_5" data file which is a projection of COVID-19 cases by group of 5 years, and the "Output_10" data file which is a projection of COVID-19 cases by group of 10 years. For our analyses we have used the "Output_5" which deals with the heterogeneity of countries' reporting format by using spline approximations when the data for this age bracket is not available for a country. Therefore, it allows a precise analysis between age groups under 24 while age groups of 25 and above are reduced to 10 year brackets and groups above 64 concatenated all together.

In order to cross validate the data of obtained after spline approximations, a comparison with the data published by the @who2022https reveals perfect similarities.

The original data consist in 14089320 observations of 10 variables (117 distinct country, region within the country, an unique observation code, the date of the observation, the gender which can be male, female or both, the age bracket by 5 years from 0 to 100, a confirmation of the age interval for each bracket, the total number of cases so far, the total number of deaths and the total number of tests performed) from `r format(min(df_global$date), "%B %d, %Y")` to `r format(max(df_global$date), "%B %d, %Y")`. 

After removing countries with missing and inconstant values, only 22 are suitable for the data analyses. However, in order to focus this analysis to geographically and culturally comparable countries, only 12 European countries are kept: Austria, Belgium, Bulgaria, Croatia, Estonia, France, Germany, Greece, Netherlands, Portugal, Slovakia, and Spain.

The observations are reported in terms of total number of COVID-19 cases per day from the start to the pandemic. The daily number of cases at a specific date $n\prime_{t}$ is calculated with the difference between the total cases at a date $t$ and the total cases at a date $t-1$ (i.e., derivative 1). In addition the change in daily number of cases $n\prime\prime_{t}$ between $n\prime_{t}$ and $n\prime_{t-1}$ has also been calculated (i.e., derivative 2).

### School closure

To identify the impact of school closures on the number of cases information regarding the school closures on a day by day basis is required and this is taken from the “UNESCO global education coalition” (2022). For each day, in each country, the status of the schools is indicated as fully open, partially open, closed due to COVID-19, or closed due to an academic break. Because it would be difficult to measure the effect of school closures at a country level when schools are partially closed, on closures due to COVID-19, or due to an academic break are considered. Indeed, both are considered as closure at a country wide level. Note that periods of closure longer than 21 days are compared for 28 days regardless if the schools opened or not after 21 days. Any COVID-19 case numbers beyond the 28-day period are not relevant for evaluating the impact of school closures.

## Data Analysis Methodology

### Generalised Additive Model

The effect of school closure on the trend of daily COVID-19 cases is analysed for each country using a Generalised Additive Model (GAM). GAM is a flexible modelling approach that estimates non-linear relationships between variables. Compared to other methods such as Vector Autoregression, GAM can handle fixed and random smooth effects without making strict assumptions about linearity.

The GAM is fitted on the daily COVID-19 cases to test the hypothesis of a significant non-linear evolution of cases among age groups from 0 to 4, from 5 to 9, from 10 to 14, from 15 to 19, and from 20 to 24 [@wood2017generalized]. The model also estimates the overall non-linear effect by country taking into account the interaction between age groups and countries as random intercepts and the interaction between time, countries and period of closure as random effects (Eq 1).

By estimating the degree of smoothness of a Bayesian spline smoothing using restricted fast maximum likelihood estimation [@wood2011fast], GAM identifies dynamic patterns underlying the evolution of COVID-19 cases reported while taking into account the random effect of different age groups and countries as follows:

\begin{align*}
  \tag{1}
  n\prime_t &\sim Poisson(\mu_t) \\
  \log(\mu_t) &= \beta_0 + \beta_1\,wave_t + \beta_2\,country_t + \beta_3\,age\,group_t + \\
              & f_1(closure_t) + f_2(closure_t,country_t) + f_3(closure_t,age\,group_t)
\end{align*}

\noindent where $n\prime_t$ represents the confirmed COVID-19 cases assuming a Poisson distribution for the fitting [@loader2006local] and $t$ is the date corresponding to the confirmed COVID-19 cases. The response variable includes a specific random effect taking into account variation within waves of school closure, countries, and age groups. The terms $f_1$ to $f_3$ are smooth functions of the time since closure, the time since closure for each country, and the time since closure for each age group. The restricted maximum likelihood (REML) was used to avoid overfitting while estimating smoothing parameters. In order to accurately account for the autocorrelation arising from the time series data, the residuals are modeled using an AR1 error model. By incorporating the autoregressive component, the AR1 model acknowledges the dependence of each residual on its previous value, thus providing a comprehensive representation of the data's temporal dynamics.

### Transfer Entropy 

Transfer entropy ($T$) can be used to infer the temporal relationship between two time series $X$ and $Y$. This measure indicates whether changes of in COVID-19 cases within a certain age group $X$ can be used to to reduce the uncertainty on the future COVID-19 cases within a another age group $Y$. If it does, $T$ is considered as evidence of a causal effect from the age group $X$ to the age group $Y$ [@schreiber2000measuring]. As such, Granger causality is a special case of transfer entropy applied to times series that are jointly Gaussian distributed [@barnett2009granger]. Therefore, transfer entropy is a more robust analysis of times series especially when applied to the impact of age cohort in pandemic transmission [@kissler2020symbolic].

The influence of the evolution in COVID-19 cases across all age groups is evaluated using Shannon's transfer entropy is given by:
  
\begin{align}
  \tag{2}
  T_{ag\,x \rightarrow\,ag\,y}(k,l) = \sum_{ag\,x,ag\,y} p\left(ag\,x_{t+1}, ag\,x_t^{(k)}, ag\,y_t^{(l)}\right) \log \left(\frac{p\left(ag\,x_{t+1}| ag\,x_t^{(k)}, ag\,y_t^{(l)}\right)}{p\left(ag\,x_{t+1}|ag\,x_t^{(k)}\right)}\right)
\end{align}

\noindent where $T_{ag\,x \rightarrow\,ag\,y}$ consequently measures the influence of the change dynamic from an age group $X$ (or $ag\,x$) to another age group $Y$ (or $ag\,y$) for every country (Eq 2). 

The day-by-day difference in COVID-19 confirmed cases $n\prime\prime_t$ is used to satisfy the stationary requirement for the calculation of Shannon's Transfer Entropy [@shannon1948mathematical; @behrendt2019rtransferentropy].

Results
===================

Overall, the trend of confirmed COVID-19 cases follows similar patterns across the selected European countries with scales respecting the size of population in these countries (Figure \@ref(fig:overall)). Indeed, the bigger the country, the higher the total number of COVID-19 cases.

```{r overall, fig.height=3, out.width="\\textwidth", fig.cap="(ref:overall)"}
overall_plot <- df_global |> 
  mutate(
    country = fct_rev(country)
  ) |> 
  ggplot(aes(date, cumulative_cases_cal, group = country)) +
  geom_line(na.rm = TRUE, color = "gray40", alpha = 0.4) +
  geom_text_repel(
    data = df_global |>
      group_by(country) |>
      slice_max(cumulative_cases_cal, with_ties = FALSE),
    aes(label = country),
    hjust = 0,
    direction = "y",
    segment.color = NA,
    seed = 123,
    size = 2,
    force = 0.5,
    family = "serif"
  ) +
  scale_x_date(
    "Date", 
    date_breaks = "3 months", 
    date_labels = "%b %y", 
    limits = c(as.Date("2020-02-01"), as.Date("2022-05-01"))
  ) +
  scale_y_continuous(
    "Total COVID-19 Cases (Million)", 
    labels = unit_format(unit = "M", scale = 1e-6)
  ) +
  theme_bw() +
  theme(
    legend.position = "none",
    text = element_text(size = 10, family = "serif")
  )

overall_plot
```

The evolution of COVID-19 cases reveals some similarities across all age groups. However, the influence of each waves on each age group has also some particularities (Figure \@ref(fig:descriptive)). For example, the first wave was more important among the oldest age groups whereas the third wave was more important among the youngest age groups.

```{r descriptive, fig.height=3, out.width="\\textwidth", fig.cap="(ref:descriptive)"}
descriptive_plot <- df_global |> 
  filter(schools_closed == 1) |> 
  mutate(
    status = status |> 
      str_remove("Closed due to ") |> 
      fct_rev(),
    country = country |> 
      fct_rev()
  ) |> 
  ggplot(aes(date, country, color = status)) +
  geom_point(na.rm = TRUE) +
  scale_x_date("Date", date_breaks = "3 months", date_labels = "%b %y") +
  scale_y_discrete("Selected European Countries") +
  scale_colour_manual("Schools Closure Reason", values = c("gray10", "gray60")) +
  theme_bw() +
  theme(
    legend.position = "bottom",
    text = element_text(size = 10, family = "serif")
  )

descriptive_plot
```

In order to evaluate the shape of the trend in the numbers of COVID-19 cases reported after the three school closure longer than 21 consecutive days, a GAM was fitted as described above, taking into account the overall effect across all the selected European countries as well as the effect for age groups: 0 to 4, 5 to 9, 10 to 14, 15 to 19, and 20 to 24 year old. The obtained results satisfy the requirements to fit this model which explains `r percent(gam_summary$dev.expl, accuracy = 0.1)` of the deviance in COVID-19 cases.

Overall, the results revealed a decreasing non-linear effect of school closure at a country level for the selected European countries (Austria: `r gam_results["Austria"]`; Belgium: `r gam_results["Belgium"]`; Bulgaria: `r gam_results["Bulgaria"]`; Croatia: `r gam_results["Croatia"]`; Estonia: `r gam_results["Estonia"]`; France: `r gam_results["France"]`; Germany (`r gam_results["Germany"]`); Greece: `r gam_results["Greece"]`; The Netherlands: `r gam_results["Netherlands"]`; Portugal: `r gam_results["Portugal"]`; Slovakia (`r gam_results["Slovakia"]`; Spain: `r gam_results["Spain"]`, see Figure \@ref(fig:age)).

```{r country, fig.height=5, out.width="\\textwidth", fig.cap="(ref:country)"}
gam_plot_country
```

Considering all countries, the analysis of age groups reveals distinct patterns (Figure \@ref(fig:age)). The 0 to 4 age group experiences a downward trend during the initial two weeks following school closure, followed by stabilization (`r gam_results["0to4"]`). In contrast, age groups ranging from 5 to 14 exhibit a substantial increase in cases after 14 days of school closure (5 to 9 age group: `r gam_results["5to9"]` and 10 to 14 age group: `r gam_results["10to14"]`). Moving on, age groups between 15 and 24 demonstrate a notable surge immediately after school closure, followed by a decrease after 14 days (15 to 19 age group: `r gam_results["15to19"]` and 20 to 24 age group: `r gam_results["20to24"]`).

```{r age, fig.height=3, out.width="\\textwidth", fig.cap="(ref:age)"}
gam_plot_age
```

Before the Transfer Entropy analysis is carried out, an Augmented Dickey-Fuller has been applied on each age group in order to insure that the daily changes in COVID-19 cases are stationary (see Appendix 1).

The results of the transfer entropy calculations between age groups for each of the 12 selected European countries are reported Figure \@ref(fig:te). The absence of symmetry between influencing age groups (i.e., $ag\,x$) and influenced age groups (i.e., $ag\,y$) is found. Indeed, the change in COVID-19 cases in some age groups are influenced by other age groups but they are not reciprocally influencing these age groups.

Figure \@ref(fig:te) shows how different age cohorts influence the COVID-19 case numbers of all age groups across countries. The upper left quadrant indicates how younger age cohorts are influencing older age cohorts, the bottom right quadrant indicates how older age cohorts are influencing younger age cohorts, finally lower left and and upper right are indicating how younger or older age cohorts are influencing themselves. By analysing these quadrant it is possible to identify similar patterns across multiple countries. Indeed, it appears that Austria, Germany and The Netherlands have significantly higher $T$ coefficients in the upper left quadrant of the matrix, which indicate that the daily changes in COVID-19 cases number in younger cohorts is predicting the the daily changes in COVID-19 cases number in older cohorts. Alternatively, it appears that Austria, the Netherlands, Portugal and Spain have significantly higher $T$ coefficients in the lower right quadrant of the matrix, which indicate that the daily changes in COVID-19 cases number in older cohorts is predicting the the daily changes in COVID-19 cases number in younger cohorts.

```{r te, fig.height=8, out.width="\\textwidth", fig.cap="(ref:te)"}
te_plot
```

Discussion & Conclusion
===================

Knowledge about the transmission of the virus significantly improved with the amount of studies performed, especially in the case of how the virus behaves with children. From the early analyses showing that the virus was instantness in children [@li2020role], the results has changed to more nuanced position which states that the spread of the virus in children is moderate.

Regarding the influence of school closures on age groups, the study reveals both similarities and specific characteristics. While there are commonalities in the evolution of COVID-19 cases across all European countries investigated, school closures exhibit distinct impacts on different age groups. Notably, the analysis shows that the 0 to 4 age group experiences a downward trend in COVID-19 cases during the initial two weeks following school closure, followed by stabilization. In contrast, age groups ranging from 5 to 14 exhibit a substantial increase in cases after 14 days of school closure. Additionally, age groups between 15 and 24 demonstrate a notable surge immediately after school closure, followed by a decrease after 14 days. These results are partially replicating observations from @alfano2022effects while providing a clearer picture of the structure of the effect of school closure.

Moreover, the paper includes Transfer Entropy calculations between age groups for each of the 12 selected European countries. The results reveal an absence of symmetry between influencing age groups (X) and influenced age groups (Y). Some age groups influence the COVID-19 case numbers of other age groups, but there is no reciprocal influence. This finding suggests that changes in COVID-19 cases in certain age groups can predict the changes in other age groups but not vice versa. The absence of reciprocity in the influence of age groups on each other suggests the presence of unidirectional relationships. These findings imply that changes in COVID-19 cases in certain age groups can serve as predictors for changes in other age groups, highlighting the importance of considering intergenerational interactions in designing effective control measures.

Furthermore, the quadrant analysis reveals similar patterns across multiple countries. Austria, Germany, and the Netherlands exhibit significantly higher TE coefficients in the upper left quadrant, indicating that changes in COVID-19 cases in younger cohorts predict the changes in older cohorts. On the other hand, Austria, the Netherlands, Portugal, and Spain show higher TE coefficients in the lower right quadrant, indicating that changes in COVID-19 cases in older cohorts predict the changes in younger cohorts. 

In conclusion, this study sheds light on the trends and patterns of confirmed COVID-19 cases in selected European countries, with a particular focus on the influence of age groups and school closures. It suggests that like lockdowns [@alfano2020efficacy; @molefi2021impact], prolonged school closures can contribute to mitigating the spread of the virus, particularly in the context of decreasing case numbers over time. However, it is crucial to consider the specific dynamics of different age groups, as the impact of school closures varies among them. The study reveals important insights that can contribute to our understanding of the dynamics of the pandemic and inform public health strategies.

Data Availability
===================

All data extracted from the COVerAGE-DB project and from the UNESCO global education coalition that are used to produce these results are fully available here https://github.com/damien-dupre/covid_ts_causality. The repository also includes the R code that were used to produce these results.

